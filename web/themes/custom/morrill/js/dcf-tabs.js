define(["exports","./dcf-utility"],function(t,s){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){t=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0===r)return("string"===e?String:Number)(t);r=r.call(t,e||"default");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"==n(t)?t:t+""}(i.key),i)}}Object.defineProperty(t,"__esModule",{value:!0}),t.DCFTabs=void 0;t.DCFTabs=function(){function n(t){var e=this,r=n;if(!(e instanceof r))throw new TypeError("Cannot call a class as a function");this.tabsReadyEvent=new Event(n.events("tabsReady")),this.tabSwitchedEvent=new Event(n.events("tabSwitched")),this.tabGroups=t,NodeList.prototype.isPrototypeOf(this.tabGroups)?this.tabGroups=Array.from(this.tabGroups):Array.isArray(this.tabGroups)||(this.tabGroups=[this.tabGroups])}return t=n,r=[{key:"events",value:function(t){var e={tabsReady:"ready",tabSwitched:"tabSwitched",commandSwitch:"commandSwitch",commandPrev:"commandPrev",commandNext:"commandNext",commandHome:"commandHome",commandEnd:"commandEnd"};return Object.freeze(e),t in e?e[t]:void 0}}],(e=[{key:"initialize",value:function(){var o=this;this.tabGroups.forEach(function(t){var r=s.DCFUtility.uuidv4(),n=t.querySelector(".dcf-tabs > ol, .dcf-tabs > ul"),e=Array.from(t.querySelectorAll(".dcf-tabs > div:not(:empty), .dcf-tabs > section:not(:empty)"));if(null===t.getAttribute("id")&&t.setAttribute("id",s.DCFUtility.checkSetElementId(t,r.concat("-tab-group"))),e.length===s.DCFUtility.magicNumbers("int0"))throw new Error("No Panels Found",{cause:t});var i=e.filter(function(t){return null===t.getAttribute("id")});if(i.length!==s.DCFUtility.magicNumbers("int0"))throw new Error("Panels Missing Ids",{cause:i});null===n&&(n=document.createElement("ul"),e.forEach(function(t){var e=t.querySelector(".dcf-tabs-panel-title"),e=null!==e?e.innerText:"Untitled",r="true"===t.dataset.tabHidden,i=document.createElement("button"),e=(i.innerText=e,i.setAttribute("href","#".concat(t.id)),r&&i.setAttribute("hidden",""),document.createElement("li"));e.append(i),n.append(e)}),t.insertBefore(n,e[s.DCFUtility.magicNumbers("int0")])),n.classList.add("dcf-tabs-list","dcf-list-bare","dcf-mb-0"),n.setAttribute("role","tablist"),e.forEach(function(t){t.setAttribute("role","tabpanel"),t.setAttribute("tabindex","0"),t.classList.add("dcf-tabs-panel"),t.setAttribute("hidden","")});i=Array.from(n.querySelectorAll("a, button"));if(i.filter(function(t){return null===t.getAttribute("hidden")}).length===s.DCFUtility.magicNumbers("int0"))throw new Error("All Tabs Hidden");i.forEach(function(t,e){t.classList.add("dcf-tab","dcf-d-block"),t.setAttribute("role","tab"),t.setAttribute("tabindex","-1"),t.removeAttribute("aria-selected");e+=s.DCFUtility.magicNumbers("int1");if(t.setAttribute("id",s.DCFUtility.checkSetElementId(t,r.concat("-tab-",e))),t.parentNode.classList.add("dcf-tabs-list-item","dcf-mb-0"),t.parentNode.setAttribute("role","presentation"),null===t.getAttribute("href")||""===t.getAttribute("href")||!t.getAttribute("href").startsWith("#"))throw new Error("Invalid Tab href",{cause:t});e=document.getElementById(t.getAttribute("href").replace("#",""));if(null===e)throw new Error("Invalid Tab href reference",{cause:t});e.setAttribute("aria-labelledby",t.getAttribute("id")),o.setTabEventListeners(t)});var a=null;null===(a=""!==location.hash?t.querySelector('.dcf-tab[href="'.concat(location.hash,'"]:not([hidden])')):a)&&((e=Array.from(t.querySelectorAll(".dcf-tab:not([hidden])"))).forEach(function(t){var e=document.getElementById(t.getAttribute("href").replace("#",""));null===a&&o.checkPanelInURL(e.getAttribute("id"))&&(a=t)}),null===a)&&(e.forEach(function(t){var e=document.getElementById(t.getAttribute("href").replace("#",""));null===a&&"default"in e.dataset&&"true"===e.dataset.default&&(a=t)}),null===a)&&(a=e[s.DCFUtility.magicNumbers("int0")]),o.switchTab(a,!1),o.setTabGroupEventListeners(t),t.dispatchEvent(o.tabsReadyEvent)}),this.scrollToHash(),window.addEventListener("hashchange",function(){var t=document.querySelector('.dcf-tab[href="'.concat(location.hash));null!==t&&(o.switchTab(t),o.scrollToHash())})}},{key:"scrollToHash",value:function(){null!==document.querySelector('.dcf-tab[href="'.concat(location.hash))&&document.getElementById(location.hash.replace("#","")).scrollIntoView()}},{key:"checkPanelInURL",value:function(t){var e=new URL(location.href).searchParams.get("tabs");return null!==e&&e.split(" ").includes(t)}},{key:"updateURLHash",value:function(t){var e=new URL(location.href),t=t.querySelector(".dcf-tabs-panel:not([hidden])");if(null===t)throw new Error("Invalid tabGroup");e.hash=t.getAttribute("id"),history.replaceState("","",e.toString())}},{key:"updateURLParam",value:function(e){var t=new URL(location.href),r=t.searchParams.get("tabs"),i=e.querySelector(".dcf-tabs-panel:not([hidden])");if(null===i)throw new Error("Invalid tabGroup");null===r?t.searchParams.set("tabs",i.getAttribute("id")):((r=r.split(" ").filter(function(t){return null===e.querySelector("#".concat(t))})).push(i.getAttribute("id")),t.searchParams.set("tabs",r.join(" "))),history.replaceState("","",t.toString())}},{key:"setTabGroupEventListeners",value:function(t){var e=this;t.addEventListener(n.events("commandPrev"),function(){e.switchToPreviousTab(t)},!0),t.addEventListener(n.events("commandNext"),function(){e.switchToNextTab(t)},!0),t.addEventListener(n.events("commandHome"),function(){e.switchToFirstTab(t)},!0),t.addEventListener(n.events("commandEnd"),function(){e.switchToEndTab(t)},!0)}},{key:"setTabEventListeners",value:function(e){var r=this,i=e.closest(".dcf-tabs");e.addEventListener("keydown",function(t){var e;s.DCFUtility.isKeyEvent(t,s.DCFUtility.keyEvents("arrowLeft"))?null!==(e=r.switchToPreviousTab(i))&&(e.focus(),t.preventDefault(),r.updateURLHash(i)):s.DCFUtility.isKeyEvent(t,s.DCFUtility.keyEvents("arrowRight"))?null!==(e=r.switchToNextTab(i))&&(e.focus(),t.preventDefault(),r.updateURLHash(i)):s.DCFUtility.isKeyEvent(t,s.DCFUtility.keyEvents("home"))?null!==(e=r.switchToFirstTab(i))&&(e.focus(),t.preventDefault(),r.updateURLHash(i)):s.DCFUtility.isKeyEvent(t,s.DCFUtility.keyEvents("end"))&&null!==(e=r.switchToLastTab(i))&&(e.focus(),t.preventDefault(),r.updateURLHash(i))}),e.addEventListener("click",function(t){r.switchTab(e),r.updateURLHash(i),t.preventDefault()}),e.addEventListener(n.events("commandSwitch"),function(){r.switchTab(e)})}},{key:"switchToNextTab",value:function(t){var e=t.querySelector('.dcf-tab[aria-selected="true"]'),t=Array.from(e.closest(".dcf-tabs-list").querySelectorAll(".dcf-tab:not([hidden])")),r=t.findIndex(function(t){return t.isEqualNode(e)}),r=(r=r===s.DCFUtility.magicNumbers("intMinus1")?s.DCFUtility.magicNumbers("int0"):r)+s.DCFUtility.magicNumbers("int1");return r>=t.length?null:(t=t[r],this.switchTab(t),t)}},{key:"switchToPreviousTab",value:function(t){var e=t.querySelector('.dcf-tab[aria-selected="true"]'),t=Array.from(e.closest(".dcf-tabs-list").querySelectorAll(".dcf-tab:not([hidden])")),r=t.findIndex(function(t){return t.isEqualNode(e)}),r=(r=r===s.DCFUtility.magicNumbers("intMinus1")?s.DCFUtility.magicNumbers("int0"):r)-s.DCFUtility.magicNumbers("int1");return r<s.DCFUtility.magicNumbers("int0")?null:(t=t[r],this.switchTab(t),t)}},{key:"switchToFirstTab",value:function(t){t=t.querySelector('.dcf-tab[aria-selected="true"]'),t=Array.from(t.closest(".dcf-tabs-list").querySelectorAll(".dcf-tab:not([hidden])"))[s.DCFUtility.magicNumbers("int0")];return this.switchTab(t),t}},{key:"switchToLastTab",value:function(t){t=t.querySelector('.dcf-tab[aria-selected="true"]'),t=Array.from(t.closest(".dcf-tabs-list").querySelectorAll(".dcf-tab:not([hidden])")),t=t[t.length-s.DCFUtility.magicNumbers("int1")];return this.switchTab(t),t}},{key:"switchTab",value:function(r){var i=this,n=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],a=r.closest(".dcf-tabs"),t=r.closest(".dcf-tabs-list");if(null===t||null===a)throw new Error("Invalid Tab");var e=t.querySelector('.dcf-tab[aria-selected="true"]');null!==e&&e.isEqualNode(r)||(a.classList.contains("dcf-tabs-scroll")&&n&&r.scrollIntoView(),t.querySelectorAll(".dcf-tab").forEach(function(t){var e=document.getElementById(t.getAttribute("href").replace("#",""));if(null===e)throw new Error("Invalid Tab href reference",{cause:t});t.isEqualNode(r)?(t.setAttribute("tabindex","0"),t.setAttribute("aria-selected",!0),e.removeAttribute("hidden"),"true"===a.dataset.urlTracking&&n&&i.updateURLParam(a)):(t.setAttribute("tabindex","-1"),t.removeAttribute("aria-selected"),e.setAttribute("hidden",""))}),a.dispatchEvent(this.tabSwitchedEvent))}}])&&i(t.prototype,e),r&&i(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}()});