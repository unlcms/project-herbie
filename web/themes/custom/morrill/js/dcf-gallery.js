define(["exports","./dcf-utility","./dcf-modal"],function(e,o,l){function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var l=t[n];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=a(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"==a(e)?e:e+""}(l.key),l)}}function t(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(e,"__esModule",{value:!0}),e.DCFGalleryImageTheme=e.DCFGalleryImage=void 0;var c=e.DCFGalleryImageTheme=function(){return t(function e(){r(this,e)},[{key:"setThemeVariable",value:function(e,t){e in this&&a(t)==a(this[e])&&(this[e]=t)}}])}();e.DCFGalleryImage=function(){return t(function e(t,n,l){r(this,e),n instanceof c?this.theme=n:this.theme=new c,this.uuid=o.DCFUtility.uuidv4(),this.bodyScrollLock=l,this.modalId=this.uuid.concat("-gallery-modal"),this.galleryImageRunningTotal=0,this.galleryImages=t,NodeList.prototype.isPrototypeOf(this.galleryImages)?this.galleryImages=Array.from(this.galleryImages):Array.isArray(this.galleryImages)||(this.galleryImages=[this.galleryImages])},[{key:"initialize",value:function(){var t=this,e=this.createEmptyModal(),n=(document.body.append(e),this.modalObj=new l.DCFModal([e],this.bodyScrollLock),this.modalObj.initialize(),this.createModalEventListeners(e),e.querySelector(".dcf-gallery-btn-prev")),e=e.querySelector(".dcf-gallery-btn-next");n.addEventListener("click",function(){t.previousImageForModal()}),e.addEventListener("click",function(){t.nextImageForModal()}),this.galleryImages.forEach(function(e){if(!("tagName"in e)||"IMG"!==e.tagName)throw new Error('Gallery image is not an image: \n "'.concat(e.outerHTML,'"'));t.addNewGalleryImage(e)})}},{key:"createEmptyModal",value:function(){var e=document.createElement("div");return e.classList.add("dcf-modal"),e.dataset.galleryImage="galleryImage",e.setAttribute("id",this.modalId),e.setAttribute("hidden","hidden"),e.innerHTML='\n    <div class="dcf-modal-wrapper dcf-relative dcf-d-flex dcf-flex-col dcf-h-100%">\n      <div class="dcf-modal-header dcf-modal-header-gallery dcf-flex-shrink-0 dcf-d-flex dcf-jc-flex-end">\n        <h2 class="dcf-sr-only">Image Gallery</h2>\n        <button class="dcf-btn-close-modal dcf-btn dcf-btn-tertiary">Close</button>\n      </div>\n      <div class="dcf-modal-content dcf-modal-content-gallery dcf-flex-grow-1 dcf-d-grid">\n        <div class="dcf-gallery-prev dcf-d-flex dcf-ai-center">\n          <button class="dcf-btn dcf-btn-secondary dcf-gallery-btn-prev dcf-d-flex dcf-jc-center dcf-ai-center dcf-h-7 dcf-w-7 dcf-p-0 dcf-circle">\n              <span class="dcf-sr-only">Previous Image</span>\n              <svg xmlns="http://www.w3.org/2000/svg" class="dcf-fill-current dcf-h-4 dcf-w-4 dcf-d-block" style="rotate: 180deg;" viewBox="0 0 30 36">\n                <path d="M25.5,15.3L9.3,0.9C8.6,0.3,7.6,0,6.7,0c-1,0.1-1.9,0.5-2.5,1.2\n                C3.5,2,3.2,2.9,3.3,3.8c0.1,1,0.5,1.9,1.2,2.5L17.7,18\n                L4.5,29.7c-0.7,0.6-1.2,1.5-1.2,2.5c-0.1,1,0.3,1.9,0.9,2.6\n                C4.8,35.5,5.8,36,6.9,36c0.9,0,1.7-0.3,2.4-0.9l16.3-14.4\n                c0.8-0.7,1.2-1.7,1.2-2.7S26.3,16,25.5,15.3z"/>\n              </svg>\n          </button>\n        </div>\n        <div class="dcf-gallery-next dcf-d-flex dcf-ai-center">\n          <button\n          class="dcf-btn dcf-btn-secondary dcf-gallery-btn-next dcf-d-flex dcf-jc-center dcf-ai-center dcf-h-7 dcf-w-7 dcf-p-0 dcf-circle">\n            <span class="dcf-sr-only">Next Image</span>\n            <svg xmlns="http://www.w3.org/2000/svg" class="dcf-fill-current dcf-h-4 dcf-w-4 dcf-d-block" viewBox="0 0 30 36">\n              <path d="M25.5,15.3L9.3,0.9C8.6,0.3,7.6,0,6.7,0c-1,0.1-1.9,0.5-2.5,1.2\n              C3.5,2,3.2,2.9,3.3,3.8c0.1,1,0.5,1.9,1.2,2.5L17.7,18\n              L4.5,29.7c-0.7,0.6-1.2,1.5-1.2,2.5c-0.1,1,0.3,1.9,0.9,2.6\n              C4.8,35.5,5.8,36,6.9,36c0.9,0,1.7-0.3,2.4-0.9l16.3-14.4\n              c0.8-0.7,1.2-1.7,1.2-2.7S26.3,16,25.5,15.3z"/>\n            </svg>\n          </button>\n        </div>\n        <div class="dcf-gallery-thumbnails dcf-overflow-y-hidden dcf-overflow-x-auto">\n          <ul class="dcf-gallery-thumbnails-list dcf-d-flex dcf-flex-nowrap dcf-mb-0" aria-label="images" role="tablist">\n          </ul>\n        </div>\n        <figure class="dcf-gallery-figure dcf-d-flex dcf-flex-col dcf-ai-center dcf-jc-center" role="tabpanel" aria-live="polite">\n        </figure>\n      </div>\n    </div>\n    ',e}},{key:"addNewGalleryImage",value:function(e){null===e.getAttribute("id")&&e.setAttribute("id",this.uuid.concat("-gallery-",this.galleryImageRunningTotal)),e.setAttribute("type","button"),e.dataset.ready="ready",this.galleryImageRunningTotal++}},{key:"createModalEventListeners",value:function(){var t=this,e="ModalPreOpenEvent_".concat(this.modalId),n="ModalCloseEvent_".concat(this.modalId);document.addEventListener(e,this.openModal.bind(this)),document.addEventListener(n,this.closeModal.bind(this)),document.addEventListener("click",function(e){e=e.target.closest("img.dcf-gallery-img");null!==e&&("ready"!==e.dataset.ready&&t.addNewGalleryImage(e),t.modalObj.toggleModal(t.modalId,e.getAttribute("id")))})}},{key:"openModal",value:function(e){var l=this,t=document.getElementById(this.modalId);if(null===t)throw new Error("Can not find gallery image modal!");var n=document.querySelectorAll("img.dcf-gallery-img"),a=e.detail.btn||null;if(n.length===o.DCFUtility.magicNumbers("int0"))throw new Error("Can not find any gallery images!");null===a&&(a=n[o.DCFUtility.magicNumbers("int0")]);var r=t.querySelector("ul");if(null===r)throw new Error("Can not find gallery image figure!");r.innerHTML="",n.forEach(function(e,t){"ready"!==e.dataset.ready&&l.addNewGalleryImage(e);var n=!1,e=(e.getAttribute("id")===a.getAttribute("id")&&(l.replaceMainImageForModal(e),n=!0),l.cleanImageForModal(e));e.classList.add("dcf-ratio-child","dcf-obj-fit-cover"),r.innerHTML="\n        ".concat(r.innerHTML,'\n        <li class="dcf-flex-shrink-0 dcf-mb-0" role="tab"\n          aria-selected="').concat(n?"true":"false",'"\n          aria-label="image ').concat(t+o.DCFUtility.magicNumbers("int1"),'"\n          tabindex="').concat(n?"0":"-1",'"\n        >\n          <div class="dcf-ratio dcf-ratio-1x1 dcf-w-9 dcf-rounded">\n            ').concat(e.outerHTML,"\n          </div>\n        </li>\n      ")});var i=r.querySelectorAll("li");i.forEach(function(e){e.addEventListener("click",function(){l.switchToImage(e)}),e.addEventListener("keydown",function(e){"ArrowRight"===e.code&&l.nextImageForModal(!0),"ArrowLeft"===e.code&&l.previousImageForModal(!0),"Home"===e.code&&l.switchToImage(i[o.DCFUtility.magicNumbers("int0")],!0),"End"===e.code&&l.switchToImage(i[i.length-o.DCFUtility.magicNumbers("int1")],!0)})})}},{key:"closeModal",value:function(){var e=document.getElementById(this.modalId);if(null===e)throw new Error("Can not find gallery image modal!");var t=e.querySelector("ul"),e=e.querySelector("figure");if(null===t)throw new Error("Can not find gallery image list!");if(null===e)throw new Error("Can not find gallery image figure!");t.innerHTML="",e.innerHTML=""}},{key:"previousImageForModal",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=document.getElementById(this.modalId);if(null===t)throw new Error("Can not find gallery image modal!");t=t.querySelector("ul");if(null===t)throw new Error("Can not find gallery image figure!");var n=t.querySelectorAll("li"),t=t.querySelector('li[aria-selected="true"]').previousElementSibling||n[n.length-o.DCFUtility.magicNumbers("int1")];this.switchToImage(t,e)}},{key:"nextImageForModal",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=document.getElementById(this.modalId);if(null===t)throw new Error("Can not find gallery image modal!");t=t.querySelector("ul");if(null===t)throw new Error("Can not find gallery image figure!");var n=t.querySelectorAll("li"),t=t.querySelector('li[aria-selected="true"]').nextElementSibling||n[o.DCFUtility.magicNumbers("int0")];this.switchToImage(t,e)}},{key:"switchToImage",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=document.getElementById(this.modalId);if(null===n)throw new Error("Can not find gallery image modal!");n=n.querySelector("ul");if(null===n)throw new Error("Can not find gallery image figure!");n.querySelectorAll("li").forEach(function(e){e.setAttribute("tabindex","-1"),e.setAttribute("aria-selected","false")}),e.setAttribute("tabindex","0"),e.setAttribute("aria-selected","true"),!0===t&&e.focus(),this.replaceMainImageForModal(e.querySelector("img"))}},{key:"replaceMainImageForModal",value:function(e){var t=document.getElementById(this.modalId);if(null===t)throw new Error("Can not find gallery image modal!");t=t.querySelector("figure");if(null===t)throw new Error("Can not find gallery image figure!");e=this.cleanImageForModal(e);t.innerHTML='\n      <div class="dcf-gallery-img-box dcf-d-flex dcf-ai-center dcf-jc-center dcf-overflow-auto">\n        '.concat(e.outerHTML,'\n      </div>\n      <figcaption class="dcf-gallery-figcaption dcf-figcaption dcf-flex-shrink-0">\n        <span class="dcf-gallery-img-cutline">\n          ').concat(e.dataset.cutline||"",'\n        </span>\n        <small class="dcf-gallery-img-credit">\n          ').concat(e.dataset.credit||"","\n        </small>\n      </figcaption>\n    ")}},{key:"cleanImageForModal",value:function(e){e=e.cloneNode();return e.classList.remove("dcf-gallery-img","dcf-ratio-child","dcf-obj-fit-cover"),e.removeAttribute("type"),e.removeAttribute("disabled"),e.removeAttribute("id"),e}}],[{key:"events",value:function(e){var t={};return Object.freeze(t),void 0!==l.DCFModal.events(e)?l.DCFModal.events(e):e in t?t[e]:void 0}}])}()});