define(["exports","./dcf-utility"],function(e,r){function a(e,t,s){t=c(t);var a=e,t=l()?Reflect.construct(t,s||[],c(e).constructor):t.apply(e,s);if(t&&("object"==v(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");e=a;if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(l=function(){return!!e})()}function i(e,t,s,a){var l=n(c(1&a?e.prototype:e),t,s);return 2&a&&"function"==typeof l?function(e){return l.apply(s,e)}:l}function n(){return(n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,s){var a=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(a)return(a=Object.getOwnPropertyDescriptor(a,t)).get?a.get.call(arguments.length<3?e:s):a.value}).apply(null,arguments)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){var s;if(e)return"string"==typeof e?m(e,t):"Map"===(s="Object"===(s={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:s)||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?m(e,t):void 0}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,a=Array(t);s<t;s++)a[s]=e[s];return a}function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var s=0;s<t.length;s++){var a=t[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=v(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0===s)return("string"===t?String:Number)(e);s=s.call(e,t||"default");if("object"!=v(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"==v(e)?e:e+""}(a.key),a)}}function f(e,t,s){return t&&h(e.prototype,t),s&&h(e,s),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(e,"__esModule",{value:!0}),e.DCFSearchSelectTheme=e.DCFSearchSelect=void 0;var A=e.DCFSearchSelectTheme=function(){return f(function e(){b(this,e),this.searchAndSelectClassList=["dcf-relative"],this.searchAreaClassList=["dcf-relative","dcf-d-grid","dcf-overflow-x-hidden","dcf-overflow-y-auto"],this.selectedItemsListClassList=["dcf-d-flex","dcf-flex-wrap","dcf-m-0"],this.selectedItemClassList=["dcf-d-flex","dcf-flex-nowrap","dcf-ai-center","dcf-jc-center","dcf-mb-0","dcf-relative"],this.selectedItemButtonClassList=["dcf-btn","dcf-btn-secondary","dcf-h-100%","dcf-z-1"],this.selectedItemButtonSVG='\n      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" class="dcf-fill-current dcf-w-4 dcf-h-4 dcf-d-block">\n        <path d="M25.4,22.6L15.8,13l9.6-9.6C25.8,3,26,2.5,26,2s-0.2-1-0.6-1.4c-0.8-0.8-2.1-0.8-2.8,0L13,10.2L3.4,0.6\n          c-0.8-0.8-2-0.8-2.8,0c-0.8,0.8-0.8,2,0,2.8l9.6,9.6l-9.6,9.6C0.2,23,0,23.5,0,24c0,0.5,0.2,1,0.6,1.4C1,25.8,1.5,26,2,26\n          c0.5,0,1-0.2,1.4-0.6l9.6-9.6l9.6,9.6C23,25.8,23.5,26,24,26c0,0,0,0,0,0c0.5,0,1-0.2,1.4-0.6C25.8,25,26,24.5,26,24\n          C26,23.5,25.8,23,25.4,22.6z"/>\n      </svg>\n    ',this.selectedItemLabelClassList=["dcf-h-100%"],this.toggleButtonContainerClassList=["dcf-sticky","dcf-top-50%","dcf-h-0","dcf-pl-1","dcf-pr-1"],this.toggleButtonClassList=["dcf-btn","dcf-btn-tertiary","dcf-p-3"],this.toggleButtonSVG='\n      <svg\n        xmlns="http://www.w3.org/2000/svg"\n        viewBox="0 0 24 24"\n        class="dcf-fill-current dcf-w-3 dcf-h-3 dcf-d-block"\n        aria-hidden="true"\n      >\n        <path d="M23.936,2.255C23.848,2.098,23.681,2,23.5,2h-23\n          C0.32,2,0.153,2.098,0.065,2.255c-0.089,0.157-0.085,0.35,0.008,0.504\n          l11.5,19C11.663,21.908,11.826,22,12,22s0.337-0.092,0.428-0.241\n          l11.5-19C24.021,2.605,24.025,2.412,23.936,2.255z"></path>\n      </svg>\n    ',this.inputSingleClassList=["dcf-b-0"],this.inputGroupMultiple=["dcf-d-flex","dcf-flex-wrap"],this.inputMultipleClassList=["dcf-b-0","dcf-flex-grow-1","dcf-flex-shrink-0"],this.availableItemsListClassList=["dcf-absolute","dcf-d-none","dcf-mb-0","dcf-pl-0","dcf-w-100%","dcf-z-2"],this.availableItemsGroupClassList=["dcf-m-0","dcf-pl-0"],this.availableItemsGroupLabelClassList=["dcf-mb-0","dcf-bold"],this.availableItemClassList=["dcf-relative","dcf-d-flex","dcf-flex-row","dcf-flex-nowrap","dcf-jc-between","dcf-ai-center","dcf-mb-0"],this.availableItemIndicatorSVG='\n      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" class="dcf-fill-current dcf-h-4 dcf-w-4 dcf-d-block">\n        <path d="M31,0.4C30.6,0.1,30-0.1,29.4,0c-0.6,0.1-1.1,0.4-1.5,0.9\n        L10.1,26.3L3.8,20c-0.4-0.4-1-0.6-1.6-0.6c0,0,0,0,0,0\n        c-0.6,0-1.2,0.2-1.6,0.6C0.2,20.5,0,21,0,21.6\n        c0,0.6,0.2,1.2,0.7,1.6l8.1,8.1c0.4,0.4,1,0.7,1.6,0.7\n        c0.7,0,1.4-0.4,1.8-1L31.6,3.5\n        C32.3,2.5,32.1,1.1,31,0.4z"/>\n      </svg>\n    ',this.availableItemsNoResultsClassList=["dcf-mb-0","dcf-bold"]},[{key:"setThemeVariable",value:function(e,t){e in this&&v(t)==v(this[e])&&(this[e]=t)}}])}(),I=function(){return f(function e(t){var s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;b(this,e),s instanceof A?this.theme=s:this.theme=new A,this.selectElement=t,this.uuid=r.DCFUtility.uuidv4(),this.selectID=this.selectElement.getAttribute("id")||this.uuid.concat("-search-and-select-select"),this.searchAndSelectID=this.uuid.concat("-search-and-select"),this.inputID=this.uuid.concat("-search-and-select-input"),this.availableItemsListID=this.uuid.concat("-search-and-select-available-items-list"),this.searchAndSelectElement=document.createElement("div"),this.searchAndSelectElement.innerHTML='\n      <div class="dcf-search-and-select-search-area-single '.concat(this.theme.searchAreaClassList.join(" "),'" >\n        <input\n          class="').concat(this.theme.inputSingleClassList.join(" "),'"\n          type="text"\n          role="combobox"\n          id=').concat(this.inputID,'\n          aria-haspopup="listbox"\n          aria-autocomplete="list"\n          aria-expanded="false"\n          aria-controls="').concat(this.availableItemsListID,'"\n        >\n        <div class="dcf-search-and-select-open-btn ').concat(this.theme.toggleButtonContainerClassList.join(" "),'">\n          <button\n            class="').concat(this.theme.toggleButtonClassList.join(" "),'"\n            type="button"\n            tabindex="-1"\n            aria-expanded="false"\n            aria-controls="').concat(this.availableItemsListID,'"\n          >\n            ').concat(this.theme.toggleButtonSVG,"\n          </button>\n        </div>\n      </div>\n    "),(s=this.searchAndSelectElement.classList).add.apply(s,["dcf-search-and-select"].concat(d(this.theme.searchAndSelectClassList))),this.searchAndSelectElement.setAttribute("id",this.searchAndSelectID),this.searchAndSelectElement.setAttribute("hidden","hidden"),this.searchAndSelectElement.dataset.for=this.selectID,this.inputElement=this.searchAndSelectElement.querySelector("input"),this.openButtonElement=this.searchAndSelectElement.querySelector(".dcf-search-and-select-open-btn button"),this.searchAreaElement=this.searchAndSelectElement.querySelector(".dcf-search-and-select-search-area-single"),this.parsedSelect=this.parseSelect(),this.currentFocus=null,this.listOfAvailableItems=[]},[{key:"init",value:function(){var e;this.selectElement.after(this.searchAndSelectElement),this.availableItemsListElement=this.buildAvailableItems(),this.availableItemsListElement.setAttribute("id",this.availableItemsListID),(e=this.availableItemsListElement.classList).add.apply(e,["dcf-search-and-select-available-items"].concat(d(this.theme.availableItemsListClassList))),this.searchAndSelectElement.append(this.availableItemsListElement),this.fixSelectReferences(),this.transferSelectAttributes(),this.setDisabled(null!==this.selectElement.getAttribute("disabled")),this.setReadOnly(null!==this.selectElement.getAttribute("readonly")),this.addEventListeners(),this.searchAndSelectElement.removeAttribute("hidden")}},{key:"fixSelectReferences",value:function(){var s=this;["for","aria-controls","aria-describedby"].forEach(function(t){document.querySelectorAll("[".concat(t,'="').concat(s.selectID,'"]')).forEach(function(e){e.setAttribute(t,s.inputID)})})}},{key:"transferSelectAttributes",value:function(){var t=this;["aria-describedby","aria-label","aria-labelledby","aria-owns"].forEach(function(e){null!==t.selectElement.getAttribute(e)&&t.inputElement.setAttribute(e,t.selectElement.getAttribute(e))})}},{key:"parseSelect",value:function(){var e=this.parseSelectInner(this.selectElement),t=e.optgroups;return e.options.length>r.DCFUtility.magicNumbers("int0")&&t.push({tag:"optgroup",label:"Other",element:this.selectElement,items:e.options}),t}},{key:"parseSelectInner",value:function(e){var t,s=[],a=[],l=function(e,t){var s,a,l,i,n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return l=!(a=!0),{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw s}}};if(Array.isArray(e)||(n=u(e))||t&&e&&"number"==typeof e.length)return n&&(e=n),i=0,{s:t=function(){},n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e.children);try{for(l.s();!(t=l.n()).done;){var i,n,c=t.value;"OPTGROUP"===c.tagName?(n=(i=this.parseSelectInner(c)).optgroups,s.push.apply(s,d(n)),s.push({tag:"optgroup",label:c.getAttribute("label"),element:c,items:i.options})):"OPTION"===c.tagName&&a.push({tag:"option",label:c.innerHTML,value:c.getAttribute("value"),selected:null!==c.getAttribute("selected"),disabled:null!==c.getAttribute("disabled"),id:r.DCFUtility.uuidv4().concat("-search-and-select-option"),element:c})}}catch(e){l.e(e)}finally{l.f()}return{optgroups:s,options:a}}},{key:"buildAvailableItems",value:function(){var l=this,s=document.createElement("ul"),i=(s.setAttribute("role","listbox"),null);return this.parsedSelect.forEach(function(e){var t,a=document.createElement("ul");a.setAttribute("role","group"),(t=a.classList).add.apply(t,["dcf-search-and-select-available-items-group"].concat(d(l.theme.availableItemsGroupClassList))),l.parsedSelect.length!==r.DCFUtility.magicNumbers("int1")&&(a.innerHTML="\n        ".concat(a.innerHTML,'\n        <li\n          class="').concat(l.theme.availableItemsGroupLabelClassList.join(" "),'"\n          role="presentation"\n        >\n          ').concat(e.label,"\n        </li>\n      ")),e.items.forEach(function(e){var t,s=document.createElement("li");(t=s.classList).add.apply(t,["dcf-search-and-select-available-item","dcf-search-and-select-clickable"].concat(d(l.theme.availableItemClassList))),s.setAttribute("role","option"),s.setAttribute("aria-selected","false"),s.setAttribute("aria-disabled",e.disabled),s.setAttribute("id","".concat(e.id,"-available")),s.dataset.value=e.value,s.dataset.label=e.label,s.dataset.id=e.id,s.innerHTML='\n          <span class="dcf-search-and-select-available-item-label">\n            '.concat(e.label,'\n          </span>\n          <span class="dcf-search-and-select-available-item-indicator" aria-hidden="true">\n            ').concat(l.theme.availableItemIndicatorSVG,"\n          </span>\n        "),a.append(s),!1===e.disabled&&!0===e.selected&&(i=s)}),s.append(a)}),null!==i&&(i.setAttribute("aria-selected","true"),this.inputElement.value=i.dataset.label),s}},{key:"addEventListeners",value:function(){var i=this;document.body.addEventListener("pointerup",function(e){i.searchAndSelectElement.contains(e.target)||(i.closeAvailableItems(),i.setVisualFocusOn(!1))},!0),this.searchAreaElement.addEventListener("click",function(){i.isComponentDisabled()||(i.setVisualFocusOn(i.searchAreaElement),i.inputElement.focus(),i.isComponentReadOnly()||i.isAvailableItemsOpen()?i.closeAvailableItems():(i.filterAvailableItems(),i.openAvailableItems()))}),this.inputElement.addEventListener("focus",function(){i.setVisualFocusOn(i.searchAreaElement)}),this.inputElement.addEventListener("keydown",function(e){if(!i.isComponentReadOnly()){var t,s=e.altKey,a=!1,l=i.inputElement.value.length;switch(e.code){case"Enter":i.visualFocusOnAvailableItems()?!1===(t=i.getAvailableItemActiveDescendant())||i.isAvailableItemDisabled(t)||(i.isAvailableItemSelected(t)?i.removeAvailableItem(t):i.selectAvailableItem(t)):(i.isAvailableItemsOpen()||(i.filterAvailableItems(),i.openAvailableItems()),i.setVisualFocusOn(i.availableItemsListElement),i.setAvailableItemActiveDescendant(i.getFirstAvailableItem()),i.scrollActiveAvailableItemInView()),a=!0;break;case"Down":case"ArrowDown":s?i.isAvailableItemsOpen()||(i.filterAvailableItems(),i.openAvailableItems()):(i.isAvailableItemsOpen()||(i.filterAvailableItems(),i.openAvailableItems()),i.visualFocusOnAvailableItems()?(i.setVisualFocusOn(i.availableItemsListElement),i.setAvailableItemActiveDescendant(i.getNextAvailableItem())):(i.setVisualFocusOn(i.availableItemsListElement),i.setAvailableItemActiveDescendant(i.getFirstAvailableItem())),i.scrollActiveAvailableItemInView()),a=!0;break;case"Esc":case"Escape":i.isAvailableItemsOpen()&&(i.closeAvailableItems(!0),i.setVisualFocusOn(i.searchAreaElement)),a=!0;break;case"Up":case"ArrowUp":s?i.isAvailableItemsOpen()||(i.filterAvailableItems(),i.openAvailableItems()):(i.isAvailableItemsOpen()||(i.filterAvailableItems(),i.openAvailableItems()),i.visualFocusOnAvailableItems()?(i.setVisualFocusOn(i.availableItemsListElement),i.setAvailableItemActiveDescendant(i.getPreviousAvailableItem())):(i.setVisualFocusOn(i.availableItemsListElement),i.setAvailableItemActiveDescendant(i.getLastAvailableItem())),i.scrollActiveAvailableItemInView()),a=!0;break;case"Tab":i.closeAvailableItems(!0),i.setVisualFocusOn(!1);break;case"Home":i.inputElement.setSelectionRange(r.DCFUtility.magicNumbers("int0"),r.DCFUtility.magicNumbers("int0")),a=!0;break;case"End":i.inputElement.setSelectionRange(l,l),a=!0}a&&(e.stopPropagation(),e.preventDefault())}}),this.inputElement.addEventListener("keyup",function(e){if(!i.isComponentReadOnly()){var t=e.key,s=!1;if("Escape"!==e.key&&"Esc"!==e.key){switch(e.code){case"Backspace":i.setVisualFocusOn(i.searchAreaElement),i.filterAvailableItems(),i.setAvailableItemActiveDescendant(!1),s=!0;break;case"Left":case"ArrowLeft":case"Right":case"ArrowRight":case"Home":case"End":i.setVisualFocusOn(i.searchAreaElement),s=!0;break;default:i.isPrintableCharacter(t)&&(i.setVisualFocusOn(i.searchAreaElement),i.filterAvailableItems(),i.openAvailableItems(),i.setAvailableItemActiveDescendant(!1))}s&&(e.stopPropagation(),e.preventDefault())}}}),this.availableItemsListElement.addEventListener("click",function(e){e=e.target.closest(".dcf-search-and-select-available-item");null!==e&&(i.isAvailableItemDisabled(e)||(i.isAvailableItemSelected(e)?i.removeAvailableItem(e):i.selectAvailableItem(e)),i.inputElement.focus(),i.setVisualFocusOn(i.availableItemsListElement),i.setAvailableItemActiveDescendant(e))}),this.availableItemsListElement.addEventListener("pointermove",function(e){var t=i.getAvailableItemActiveDescendant(),e=e.target.closest(".dcf-search-and-select-available-item");null===e||!1!==t&&e.isSameNode(t)||i.setAvailableItemActiveDescendant(e)}),this.availableItemsListElement.addEventListener("pointerout",function(e){i.availableItemsListElement.isSameNode(e.target)&&i.setAvailableItemActiveDescendant(!1)})}},{key:"setDisabled",value:function(e){("boolean"!=typeof e?!1:e)?(this.inputElement.setAttribute("disabled","disabled"),this.openButtonElement.setAttribute("disabled","disabled"),this.searchAndSelectElement.classList.add("dcf-search-and-select-disabled"),this.setVisualFocusOn(!1),this.closeAvailableItems()):(this.inputElement.removeAttribute("disabled"),this.openButtonElement.removeAttribute("disabled"),this.searchAndSelectElement.classList.remove("dcf-search-and-select-disabled"))}},{key:"isComponentDisabled",value:function(){return null!==this.inputElement.getAttribute("disabled")}},{key:"setReadOnly",value:function(e){("boolean"!=typeof e?!1:e)?(this.inputElement.setAttribute("readonly","readonly"),this.openButtonElement.setAttribute("readonly","readonly"),this.closeAvailableItems()):(this.inputElement.removeAttribute("readonly"),this.openButtonElement.removeAttribute("readonly"))}},{key:"isComponentReadOnly",value:function(){return null!==this.inputElement.getAttribute("readonly")}},{key:"isPrintableCharacter",value:function(e){return e.length===r.DCFUtility.magicNumbers("int1")&&e.match(/\S| /)}},{key:"isAvailableItemsOpen",value:function(){return!this.availableItemsListElement.classList.contains("dcf-d-none")}},{key:"openAvailableItems",value:function(){this.inputElement.setAttribute("aria-expanded","true"),this.openButtonElement.setAttribute("aria-expanded","true"),this.availableItemsListElement.classList.remove("dcf-d-none")}},{key:"closeAvailableItems",value:function(){this.inputElement.setAttribute("aria-expanded","false"),this.openButtonElement.setAttribute("aria-expanded","false"),this.availableItemsListElement.classList.add("dcf-d-none")}},{key:"visualFocusOnAvailableItems",value:function(){return"true"===this.availableItemsListElement.dataset.focused}},{key:"setVisualFocusOn",value:function(e){null!==this.currentFocus&&this.availableItemsListElement.isSameNode(this.currentFocus)?(this.searchAreaElement.classList.remove("dcf-search-and-select-visual-focus"),delete this.availableItemsListElement.dataset.focused):null!==this.currentFocus&&(this.currentFocus.classList.remove("dcf-search-and-select-visual-focus"),delete this.currentFocus.dataset.focused),!1!==e&&this.availableItemsListElement.isSameNode(e)?(this.searchAreaElement.classList.add("dcf-search-and-select-visual-focus"),this.availableItemsListElement.dataset.focused="true",this.currentFocus=e):!1!==e?(e.classList.add("dcf-search-and-select-visual-focus"),e.dataset.focused="true",this.currentFocus=e):this.currentFocus=null}},{key:"setVisualHover",value:function(e){this.searchAndSelectElement.querySelectorAll(".dcf-search-and-select-visual-hover").forEach(function(e){e.classList.remove("dcf-search-and-select-visual-hover")}),!1!==e?(e.classList.add("dcf-search-and-select-visual-hover"),this.currentHover=e):this.currentHover=null}},{key:"getAvailableItemActiveDescendant",value:function(){var e=this.inputElement.getAttribute("aria-activedescendant");if(null!==e&&""!==e){e=document.getElementById(e);if(null!==e)return e}return!1}},{key:"setAvailableItemActiveDescendant",value:function(e){if(!1!==e&&!this.isElementAnAvailableItem(e))throw new Error("Element is not an available item");!1!==e?(this.inputElement.setAttribute("aria-activedescendant",e.getAttribute("id")),this.setVisualHover(e)):(this.setVisualHover(!1),this.inputElement.setAttribute("aria-activedescendant",""))}},{key:"scrollActiveAvailableItemInView",value:function(){var e=this.getAvailableItemActiveDescendant();!1===e||this.isAvailableItemInView(e)||e.scrollIntoView({behavior:"smooth",block:"nearest"})}},{key:"getNextAvailableItem",value:function(){for(var e=null,t=!1,s=0;s<this.listOfAvailableItems.length;s++){if(t){e=this.listOfAvailableItems[s];break}this.listOfAvailableItems[s].getAttribute("id")===this.inputElement.getAttribute("aria-activedescendant")&&(t=!0)}return null===e?this.getFirstAvailableItem():e}},{key:"getPreviousAvailableItem",value:function(){for(var e=null,t=0;t<this.listOfAvailableItems.length&&this.listOfAvailableItems[t].getAttribute("id")!==this.inputElement.getAttribute("aria-activedescendant");t++)e=this.listOfAvailableItems[t];return null===e?this.getLastAvailableItem():e}},{key:"getFirstAvailableItem",value:function(){return this.listOfAvailableItems.length!==r.DCFUtility.magicNumbers("int0")&&this.listOfAvailableItems[r.DCFUtility.magicNumbers("int0")]}},{key:"getLastAvailableItem",value:function(){return this.listOfAvailableItems.length!==r.DCFUtility.magicNumbers("int0")&&this.listOfAvailableItems[this.listOfAvailableItems.length-r.DCFUtility.magicNumbers("int1")]}},{key:"selectAvailableItem",value:function(t){if(!this.isElementAnAvailableItem(t))throw new Error("Element is not an available item");this.availableItemsListElement.querySelectorAll("li.dcf-search-and-select-available-item").forEach(function(e){e.setAttribute("aria-selected","false")}),t.setAttribute("aria-selected","true"),this.selectElement.querySelectorAll("option").forEach(function(e){e.value===t.dataset.value?e.setAttribute("selected","selected"):e.removeAttribute("selected","selected")}),this.closeAvailableItems(),this.inputElement.value=t.dataset.label}},{key:"removeAvailableItem",value:function(t){if(!this.isElementAnAvailableItem(t))throw new Error("Element is not an available item");t.setAttribute("aria-selected","false"),this.selectElement.querySelectorAll("option").forEach(function(e){e.value===t.dataset.value&&e.removeAttribute("selected")})}},{key:"isElementAnAvailableItem",value:function(e){return e.classList.contains("dcf-search-and-select-available-item")}},{key:"isAvailableItemSelected",value:function(e){if(this.isElementAnAvailableItem(e))return"true"===e.getAttribute("aria-selected");throw new Error("Element is not an available item")}},{key:"isAvailableItemDisabled",value:function(e){if(this.isElementAnAvailableItem(e))return"true"===e.getAttribute("aria-disabled");throw new Error("Element is not an available item")}},{key:"isAvailableItemInView",value:function(e){var t;if(this.isElementAnAvailableItem(e))return t=this.availableItemsListElement.getBoundingClientRect(),(e=e.getBoundingClientRect()).top>=t.top&&e.bottom<=t.bottom;throw new Error("Element is not an available item")}},{key:"filterAvailableItems",value:function(){var s=this,a=this.inputElement.value.trim().toUpperCase(),e=this.availableItemsListElement.querySelectorAll("li.dcf-search-and-select-available-item"),t=this.availableItemsListElement.querySelectorAll(".dcf-search-and-select-available-items-group"),l=(this.listOfAvailableItems=[],this.availableItemsListElement.querySelectorAll(".dcf-search-and-select-no-results").forEach(function(e){e.remove()}),!0);e.forEach(function(e){var t=e.querySelector(".dcf-search-and-select-available-item-label").innerText.toUpperCase();""===a||t.includes(a)?(e.classList.remove("dcf-d-none"),e.classList.add("dcf-d-flex"),s.listOfAvailableItems.push(e),l=!1):(e.classList.add("dcf-d-none"),e.classList.remove("dcf-d-flex"))}),t.forEach(function(e){e.querySelectorAll(".dcf-search-and-select-available-item:not(.dcf-d-none)").length===r.DCFUtility.magicNumbers("int0")?e.classList.add("dcf-d-none"):e.classList.remove("dcf-d-none")}),l&&((e=document.createElement("ul")).setAttribute("role","presentation"),(t=e.classList).add.apply(t,["dcf-search-and-select-no-results"].concat(d(this.theme.availableItemsGroupClassList))),e.innerHTML='\n        <li class="'.concat(this.theme.availableItemsNoResultsClassList.join(" "),'" role="option">\n          No results found\n        </li>\n      '),this.availableItemsListElement.append(e))}}])}(),p=function(){function s(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return b(this,s),(e=a(this,s,[e,t])).selectedItemsListID=e.uuid.concat("-search-and-select-selected-items-list"),e.selectedItemsHelpID=e.uuid.concat("-search-and-select-selected-items-list-help"),e.searchAndSelectElement=document.createElement("div"),e.searchAndSelectElement.innerHTML='\n      <div class="dcf-search-and-select-search-area-multiple '.concat(e.theme.searchAreaClassList.join(" "),'" >\n        <div class="dcf-search-and-select-multiple-input-group ').concat(e.theme.inputGroupMultiple.join(" "),'">\n          <span id="').concat(e.selectedItemsHelpID,'" class="dcf-sr-only">Press Delete or Backspace to Remove.</span>\n          <ul\n            class="dcf-search-and-select-selected-items ').concat(e.theme.selectedItemsListClassList.join(" "),'"\n            role="listbox"\n            aria-describedby="').concat(e.selectedItemsHelpID,'"\n            id=').concat(e.selectedItemsListID,'\n            tabindex="-1"\n            aria-activedescendant=""\n            aria-orientation="horizontal"\n          ></ul>\n          <input\n            class="').concat(e.theme.inputMultipleClassList.join(" "),'"\n            type="text"\n            role="combobox"\n            id=').concat(e.inputID,'\n            aria-haspopup="listbox"\n            aria-autocomplete="list"\n            aria-expanded="false"\n            aria-controls="').concat(e.availableItemsListID,'"\n          >\n        </div>\n        <div class="dcf-search-and-select-open-btn ').concat(e.theme.toggleButtonContainerClassList.join(" "),'">\n          <button\n            class="').concat(e.theme.toggleButtonClassList.join(" "),'"\n            type="button"\n            tabindex="-1"\n            aria-expanded="false"\n            aria-controls="').concat(e.availableItemsListID,'"\n          >\n            ').concat(e.theme.toggleButtonSVG,"\n          </button>\n        </div>\n\n      </div>\n    "),(t=e.searchAndSelectElement.classList).add.apply(t,["dcf-search-and-select"].concat(d(e.theme.searchAndSelectClassList))),e.searchAndSelectElement.setAttribute("id",e.searchAndSelectID),e.searchAndSelectElement.setAttribute("hidden","hidden"),e.searchAndSelectElement.dataset.for=e.selectID,e.inputElement=e.searchAndSelectElement.querySelector("input"),e.selectedItemsListElement=e.searchAndSelectElement.querySelector(".dcf-search-and-select-selected-items"),e.openButtonElement=e.searchAndSelectElement.querySelector(".dcf-search-and-select-open-btn button"),e.searchAreaElement=e.searchAndSelectElement.querySelector(".dcf-search-and-select-search-area-multiple"),e.parsedSelect=e.parseSelect(),e}var e=s,t=I;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");return e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o(e,t),f(s,[{key:"init",value:function(){i(s,"init",this,3)([]),this.availableItemsListElement.setAttribute("aria-multiselectable",!0)}},{key:"buildAvailableItems",value:function(){var l=this,s=document.createElement("ul");return s.setAttribute("role","listbox"),this.parsedSelect.forEach(function(e){var t,a=document.createElement("ul");a.setAttribute("role","group"),(t=a.classList).add.apply(t,["dcf-search-and-select-available-items-group"].concat(d(l.theme.availableItemsGroupClassList))),l.parsedSelect.length!==r.DCFUtility.magicNumbers("int1")&&(a.innerHTML="\n        ".concat(a.innerHTML,'\n        <li\n          class="').concat(l.theme.availableItemsGroupLabelClassList.join(" "),'"\n          role="presentation"\n        >\n          ').concat(e.label,"\n        </li>\n      ")),e.items.forEach(function(e){var t,s=document.createElement("li");(t=s.classList).add.apply(t,["dcf-search-and-select-available-item","dcf-search-and-select-clickable"].concat(d(l.theme.availableItemClassList))),s.setAttribute("role","option"),s.setAttribute("aria-selected",e.disabled?"false":e.selected),s.setAttribute("aria-disabled",e.disabled),s.setAttribute("id","".concat(e.id,"-available")),s.dataset.value=e.value,s.dataset.id=e.id,s.innerHTML='\n          <span class="dcf-search-and-select-available-item-label">\n            '.concat(e.label,'\n          </span>\n          <span class="dcf-search-and-select-available-item-indicator" aria-hidden="true">\n            ').concat(l.theme.availableItemIndicatorSVG,"\n          </span>\n        "),a.append(s),!1===e.disabled&&!0===e.selected&&(l.appendNewSelectedItem(s),l.selectedItemsListElement.setAttribute("tabindex","0"))}),s.append(a)}),s}},{key:"appendNewSelectedItem",value:function(e){var t;if(!this.isElementAnAvailableItem(e))throw new Error("Element is not an available item");var s=document.createElement("li");s.dataset.id=e.dataset.id,s.setAttribute("id","".concat(e.dataset.id,"-selected")),(t=s.classList).add.apply(t,["dcf-search-and-select-selected-item","dcf-search-and-select-clickable"].concat(d(this.theme.selectedItemClassList))),s.innerHTML='\n      <button\n        class="\n          dcf-search-and-select-selected-item-remove-btn\n          '.concat(this.theme.selectedItemButtonClassList.join(" "),'\n        "\n        type="button"\n        tabindex="-1"\n      >\n        ').concat(this.theme.selectedItemButtonSVG,'\n      </button>\n      <span class="\n        dcf-search-and-select-selected-item-label\n        ').concat(this.theme.selectedItemLabelClassList.join(" "),'">\n        ').concat(e.querySelector(".dcf-search-and-select-available-item-label").innerText,"\n      </span>\n    "),this.selectedItemsListElement.append(s),this.isSelectedItemInView(s)||s.scrollIntoView({behavior:"smooth",block:"nearest"})}},{key:"addEventListeners",value:function(){var n=this;document.body.addEventListener("pointerup",function(e){n.searchAndSelectElement.contains(e.target)||(n.closeAvailableItems(),n.setVisualFocusOn(!1))},!0),this.searchAreaElement.addEventListener("click",function(){n.isComponentDisabled()||(n.setVisualFocusOn(n.searchAreaElement),n.inputElement.focus(),n.isAvailableItemsOpen()||n.isComponentReadOnly()?n.closeAvailableItems():(n.filterAvailableItems(),n.openAvailableItems()))}),this.inputElement.addEventListener("focus",function(){n.setVisualFocusOn(n.searchAreaElement)}),this.inputElement.addEventListener("keydown",function(e){if(!n.isComponentReadOnly()){var t,s=e.altKey,a=e.shiftKey,l=!1,i=n.inputElement.value.length;switch(e.code){case"Enter":n.visualFocusOnAvailableItems()?!1===(t=n.getAvailableItemActiveDescendant())||n.isAvailableItemDisabled(t)||(n.isAvailableItemSelected(t)?n.removeAvailableItem(t):n.selectAvailableItem(t)):(n.isAvailableItemsOpen()||(n.filterAvailableItems(),n.openAvailableItems()),n.setVisualFocusOn(n.availableItemsListElement),n.setAvailableItemActiveDescendant(n.getFirstAvailableItem()),n.scrollActiveAvailableItemInView()),l=!0;break;case"Down":case"ArrowDown":s?n.isAvailableItemsOpen()||(n.filterAvailableItems(),n.openAvailableItems()):(n.isAvailableItemsOpen()||(n.filterAvailableItems(),n.openAvailableItems()),n.visualFocusOnAvailableItems()?(n.setVisualFocusOn(n.availableItemsListElement),n.setAvailableItemActiveDescendant(n.getNextAvailableItem())):(n.setVisualFocusOn(n.availableItemsListElement),n.setAvailableItemActiveDescendant(n.getFirstAvailableItem())),n.scrollActiveAvailableItemInView()),l=!0;break;case"Esc":case"Escape":n.isAvailableItemsOpen()&&(n.closeAvailableItems(!0),n.setVisualFocusOn(n.searchAreaElement)),l=!0;break;case"Up":case"ArrowUp":s?n.isAvailableItemsOpen()||(n.filterAvailableItems(),n.openAvailableItems()):(n.isAvailableItemsOpen()||(n.filterAvailableItems(),n.openAvailableItems()),n.visualFocusOnAvailableItems()?(n.setVisualFocusOn(n.availableItemsListElement),n.setAvailableItemActiveDescendant(n.getPreviousAvailableItem())):(n.setVisualFocusOn(n.availableItemsListElement),n.setAvailableItemActiveDescendant(n.getLastAvailableItem())),n.scrollActiveAvailableItemInView()),l=!0;break;case"Tab":n.closeAvailableItems(!0),!1!==n.isSelectedItemTab()&&a||n.setVisualFocusOn(!1);break;case"Home":n.inputElement.setSelectionRange(r.DCFUtility.magicNumbers("int0"),r.DCFUtility.magicNumbers("int0")),l=!0;break;case"End":n.inputElement.setSelectionRange(i,i),l=!0}l&&(e.stopPropagation(),e.preventDefault())}}),this.inputElement.addEventListener("keyup",function(e){if(!n.isComponentReadOnly()){var t=e.key,s=!1;if("Escape"!==e.key&&"Esc"!==e.key){switch(e.code){case"Backspace":n.setVisualFocusOn(n.searchAreaElement),n.filterAvailableItems(),n.setAvailableItemActiveDescendant(!1),s=!0;break;case"Left":case"ArrowLeft":case"Right":case"ArrowRight":case"Home":case"End":n.setVisualFocusOn(n.searchAreaElement),s=!0;break;default:n.isPrintableCharacter(t)&&(n.setVisualFocusOn(n.searchAreaElement),n.filterAvailableItems(),n.openAvailableItems(),n.setAvailableItemActiveDescendant(!1))}s&&(e.stopPropagation(),e.preventDefault())}}}),this.availableItemsListElement.addEventListener("click",function(e){e=e.target.closest(".dcf-search-and-select-available-item");null!==e&&(n.isAvailableItemDisabled(e)||(n.isAvailableItemSelected(e)?n.removeAvailableItem(e):n.selectAvailableItem(e)),n.inputElement.focus(),n.setVisualFocusOn(n.availableItemsListElement),n.setAvailableItemActiveDescendant(e))}),this.availableItemsListElement.addEventListener("pointermove",function(e){var t=n.getAvailableItemActiveDescendant(),e=e.target.closest(".dcf-search-and-select-available-item");null===e||!1!==t&&e.isSameNode(t)||n.setAvailableItemActiveDescendant(e)}),this.availableItemsListElement.addEventListener("pointerout",function(e){n.availableItemsListElement.isSameNode(e.target)&&n.setAvailableItemActiveDescendant(!1)}),this.selectedItemsListElement.addEventListener("click",function(e){var t;n.isComponentDisabled()||null!==(t=e.target.closest(".dcf-search-and-select-selected-item"))&&(null===e.target.closest(".dcf-search-and-select-selected-item-remove-btn")||n.isComponentReadOnly()?(n.setVisualFocusOn(n.selectedItemsListElement),n.setAvailableItemActiveDescendant(!1),n.setSelectedItemActiveDescendant(t)):(n.selectedItemsListElement.focus(),n.removeSelectedItem(t),n.setAvailableItemActiveDescendant(!1)),e.stopPropagation())}),this.selectedItemsListElement.addEventListener("pointermove",function(e){var t,s;n.isComponentDisabled()||(t=n.getSelectedItemActiveDescendant(),null!==(s=e.target.closest(".dcf-search-and-select-selected-item"))&&(!1!==t&&s.isSameNode(t)||n.setSelectedItemActiveDescendant(s),e.stopPropagation()))}),this.selectedItemsListElement.addEventListener("pointerout",function(e){n.selectedItemsListElement.isSameNode(e.target)&&(n.setSelectedItemActiveDescendant(!1),e.stopPropagation())}),this.selectedItemsListElement.addEventListener("focus",function(){var e=n.getSelectedItemActiveDescendant();n.setVisualFocusOn(n.selectedItemsListElement),!1===e&&n.setSelectedItemActiveDescendant(n.getFirstSelectedItem())}),this.selectedItemsListElement.addEventListener("blur",function(){n.setVisualFocusOn(!1),n.setSelectedItemActiveDescendant(!1)}),this.selectedItemsListElement.addEventListener("keydown",function(e){if(!n.isComponentDisabled()){var t=!1,s=n.getSelectedItemActiveDescendant(),a=n.getFirstSelectedItem();switch(e.code){case"Left":case"ArrowLeft":!1===s&&n.setSelectedItemActiveDescendant(n.getLastSelectedItem()),n.setVisualFocusOn(n.selectedItemsListElement),n.setSelectedItemActiveDescendant(n.getPreviousSelectedItem()),n.scrollActiveSelectedItemInView(),t=!0;break;case"Right":case"ArrowRight":!1===s&&n.setSelectedItemActiveDescendant(n.getFirstSelectedItem()),n.setVisualFocusOn(n.selectedItemsListElement),n.setSelectedItemActiveDescendant(n.getNextSelectedItem()),n.scrollActiveSelectedItemInView(),t=!0;break;case"Home":n.setVisualFocusOn(n.selectedItemsListElement),n.setSelectedItemActiveDescendant(n.getFirstSelectedItem()),n.scrollActiveSelectedItemInView(),t=!0;break;case"End":n.setVisualFocusOn(n.selectedItemsListElement),n.setSelectedItemActiveDescendant(n.getLastSelectedItem()),n.scrollActiveSelectedItemInView(),t=!0;break;case"Backspace":case"Delete":n.isComponentReadOnly()||(a.isSameNode(s)?(n.removeSelectedItem(s),n.setSelectedItemActiveDescendant(n.getFirstSelectedItem())):(n.setSelectedItemActiveDescendant(n.getPreviousSelectedItem()),n.removeSelectedItem(s)),t=!0)}t&&(e.stopPropagation(),e.preventDefault())}})}},{key:"setDisabled",value:function(e){("boolean"!=typeof e?!1:e)?(this.inputElement.setAttribute("disabled","disabled"),this.openButtonElement.setAttribute("disabled","disabled"),this.searchAndSelectElement.classList.add("dcf-search-and-select-disabled"),this.selectedItemsListElement.setAttribute("aria-disabled","true"),this.selectedItemsListElement.setAttribute("tabindex","-1"),this.selectedItemsListElement.querySelectorAll("button").forEach(function(e){e.setAttribute("disabled","disabled")}),this.setVisualFocusOn(!1),this.closeAvailableItems()):(e=this.selectedItemsListElement.querySelectorAll("li"),this.inputElement.removeAttribute("disabled"),this.openButtonElement.removeAttribute("disabled"),this.searchAndSelectElement.classList.remove("dcf-search-and-select-disabled"),this.selectedItemsListElement.removeAttribute("aria-disabled"),this.selectedItemsListElement.setAttribute("tabindex",e.length===r.DCFUtility.magicNumbers("int0")?"-1":"0"),this.selectedItemsListElement.querySelectorAll("button").forEach(function(e){e.removeAttribute("disabled")}))}},{key:"setReadOnly",value:function(e){("boolean"!=typeof e?!1:e)?(this.inputElement.setAttribute("readonly","readonly"),this.openButtonElement.setAttribute("readonly","readonly"),this.selectedItemsListElement.setAttribute("aria-readonly","true"),this.selectedItemsListElement.querySelectorAll("button").forEach(function(e){e.setAttribute("readonly","readonly")}),this.closeAvailableItems()):(this.inputElement.removeAttribute("readonly"),this.openButtonElement.removeAttribute("readonly"),this.selectedItemsListElement.removeAttribute("aria-readonly"),this.selectedItemsListElement.querySelectorAll("button").forEach(function(e){e.removeAttribute("readonly")}))}},{key:"isSelectedItemTab",value:function(){return"0"===this.selectedItemsListElement.getAttribute("tabindex")}},{key:"visualFocusOnSelectedItems",value:function(){return"true"===this.selectedItemsListElement.dataset.focused}},{key:"getSelectedItemActiveDescendant",value:function(){var e=this.selectedItemsListElement.getAttribute("aria-activedescendant");if(null!==e&&""!==e){e=document.getElementById(e);if(null!==e)return e}return!1}},{key:"setSelectedItemActiveDescendant",value:function(e){if(!1!==e&&!this.isElementASelectedItem(e))throw new Error("Element is not a selected item");!1!==e?(this.selectedItemsListElement.setAttribute("aria-activedescendant",e.getAttribute("id")),this.setVisualHover(e)):(this.setVisualHover(!1),this.selectedItemsListElement.setAttribute("aria-activedescendant",""))}},{key:"scrollActiveSelectedItemInView",value:function(){var e=this.getSelectedItemActiveDescendant();!1===e||this.isSelectedItemInView(e)||e.scrollIntoView({behavior:"smooth",block:"nearest"})}},{key:"getNextSelectedItem",value:function(){var e=this.getSelectedItemActiveDescendant();return!1===e||null===(e=e.nextElementSibling)?this.getFirstSelectedItem():e}},{key:"getPreviousSelectedItem",value:function(){var e=this.getSelectedItemActiveDescendant();return!1===e||null===(e=e.previousElementSibling)?this.getLastSelectedItem():e}},{key:"getFirstSelectedItem",value:function(){var e=this.selectedItemsListElement.children;return e.length!==r.DCFUtility.magicNumbers("int0")&&e[r.DCFUtility.magicNumbers("int0")]}},{key:"getLastSelectedItem",value:function(){var e=this.selectedItemsListElement.children;return e.length!==r.DCFUtility.magicNumbers("int0")&&e[e.length-r.DCFUtility.magicNumbers("int1")]}},{key:"selectAvailableItem",value:function(t){if(!this.isElementAnAvailableItem(t))throw new Error("Element is not an available item");t.setAttribute("aria-selected","true"),this.selectElement.querySelectorAll("option").forEach(function(e){e.value===t.dataset.value&&e.setAttribute("selected","selected")}),this.appendNewSelectedItem(t),this.selectedItemsListElement.setAttribute("tabindex","0")}},{key:"removeAvailableItem",value:function(e){if(!this.isElementAnAvailableItem(e))throw new Error("Element is not an available item");i(s,"removeAvailableItem",this,3)([e]),this.selectedItemsListElement.querySelectorAll('li[data-id="'.concat(e.dataset.id,'"]')).forEach(function(e){e.remove()}),this.selectedItemsListElement.children.length===r.DCFUtility.magicNumbers("int0")&&this.selectedItemsListElement.setAttribute("tabindex","-1")}},{key:"removeSelectedItem",value:function(e){if(!this.isElementASelectedItem(e))throw new Error("Element is not a selected item");var t=this.availableItemsListElement.querySelector('li[data-id="'.concat(e.dataset.id,'"]'));t.setAttribute("aria-selected","false"),this.selectElement.querySelectorAll("option").forEach(function(e){e.value===t.dataset.value&&e.removeAttribute("selected")}),e.remove(),this.selectedItemsListElement.children.length===r.DCFUtility.magicNumbers("int0")&&(this.selectedItemsListElement.setAttribute("tabindex","-1"),this.inputElement.focus())}},{key:"isSelectedItemInView",value:function(e){var t;if(this.isElementASelectedItem(e))return t=this.searchAreaElement.getBoundingClientRect(),(e=e.getBoundingClientRect()).top>=t.top&&e.bottom<=t.bottom;throw new Error("Element is not a selected item")}},{key:"isElementASelectedItem",value:function(e){return e.classList.contains("dcf-search-and-select-selected-item")}}])}();e.DCFSearchSelect=function(){return f(function e(t,s){b(this,e),s instanceof A?this.theme=s:this.theme=new A,this.uuid=r.DCFUtility.uuidv4(),this.selects=t,NodeList.prototype.isPrototypeOf(this.selects)?this.selects=Array.from(this.selects):Array.isArray(this.selects)||(this.selects=[this.selects])},[{key:"initialize",value:function(){var s=this;this.selects.forEach(function(e,t){e.setAttribute("id",e.getAttribute("id")||s.uuid.concat("-search-and-select-label-",t)),null!==e.getAttribute("hidden")&&e.setAttribute("hidden","hidden"),new(null!==e.getAttribute("multiple")?p:I)(e,s.theme).init()})}}],[{key:"events",value:function(e){var t={};return Object.freeze(t),e in t?t[e]:void 0}}])}()});