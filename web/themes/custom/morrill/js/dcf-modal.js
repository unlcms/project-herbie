define(["exports","./dcf-utility"],function(t,u){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,function(t){t=function(t,e){if("object"!=i(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"==i(t)?t:t+""}(o.key),o)}}Object.defineProperty(t,"__esModule",{value:!0}),t.DCFModal=void 0;t.DCFModal=function(){function a(t,e){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.modals=t,this.currentModal=null,this.currentBtn=null,this.body=document.querySelector("body"),this.nonModals=[];var t=document.getElementById("dcf-skip-nav"),n=document.getElementById("dcf-header"),o=document.getElementById("dcf-main"),i=document.getElementById("dcf-footer");t&&this.nonModals.push(t),n&&this.nonModals.push(n),o&&this.nonModals.push(o),i&&this.nonModals.push(i),this.disableBodyScroll=null,this.enableBodyScroll=null,e&&e.disableBodyScroll&&e.enableBodyScroll&&(this.disableBodyScroll=e.disableBodyScroll,this.enableBodyScroll=e.enableBodyScroll)}return t=a,(e=[{key:"appendToBody",value:function(t){this.body.appendChild(t)}},{key:"toggleModal",value:function(t,e){"false"===document.getElementById(t).getAttribute("aria-hidden")?this.closeModal(t):this.openModal(t,e)}},{key:"setNavToggleBtnState",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"open",n=t.getElementsByTagName("svg"),o=t.getElementsByClassName("dcf-nav-toggle-label");n.length&&(n=n[u.DCFUtility.magicNumbers("int0")].getElementsByTagName("g"),Array.from(n).forEach(function(t){t.classList.contains("dcf-nav-toggle-icon-open")?"open"===e.toLowerCase()?t.classList.remove("dcf-d-none"):t.classList.add("dcf-d-none"):t.classList.contains("dcf-nav-toggle-icon-close")&&("open"===e.toLowerCase()?t.classList.add("dcf-d-none"):t.classList.remove("dcf-d-none"))})),o.length&&("open"===e.toLowerCase()?o[u.DCFUtility.magicNumbers("int0")].textContent=t.getAttribute("data-nav-toggle-label-open")?t.getAttribute("data-nav-toggle-label-open"):"Open":o[u.DCFUtility.magicNumbers("int0")].textContent=t.getAttribute("data-nav-toggle-label-closed")?t.getAttribute("data-nav-toggle-label-closed"):"Close")}},{key:"openModal",value:function(e,t){var o,n,i,a=this,d=document.getElementById("dcf-nav-toggle-group"),l=d&&d.parentElement?d.parentElement:null,s=(this.modals.forEach(function(t){t.getAttribute("id")!==e&&a.closeModal(t.getAttribute("id"))}),document.getElementById(e)),c="false"===s.getAttribute("aria-hidden"),r=!1;t&&(this.currentBtn=t,i=document.getElementById(t),r=i&&"true"===i.getAttribute("data-with-nav-toggle-group"))&&this.setNavToggleBtnState(i,"closed"),this.currentModal=e,c||(i="ModalPreOpenEvent_".concat(e),c=document.getElementById(t),t=new CustomEvent(i),null!==c&&(t=new CustomEvent(i,{detail:{btn:c}})),document.dispatchEvent(t),this.nonModals.forEach(function(t){r&&d&&t===l?(t.setAttribute("aria-hidden","false"),l.childNodes.forEach(function(t){t.nodeType===Node.ELEMENT_NODE&&t.setAttribute("aria-hidden",t===d?"false":"true")})):t.setAttribute("aria-hidden","true")}),this.disableBodyScroll&&this.disableBodyScroll(s,{allowTouchMove:function(t){for(var e=t;e&&e!==document.body;){if(e.classList.contains("dcf-modal-content"))return!0;e.parentElement&&(e=e.parentElement)}return!1}}),this.body.classList.add("dcf-modal-is-open"),s.setAttribute("aria-hidden","false"),s.classList.remove("dcf-opacity-0","dcf-pointer-events-none","dcf-invisible"),s.classList.add("dcf-opacity-100","dcf-pointer-events-auto"),r&&s.classList.add("dcf-z-modal-behind-nav-toggle-group"),s.focus(),o=s.querySelectorAll('button:not([hidden]):not([disabled]), [href]:not([hidden]), input:not([hidden]):not([type="hidden"]):not([disabled]), select:not([hidden]):not([disabled]), textarea:not([hidden]):not([disabled]), [tabindex="0"]:not([hidden]):not([disabled]), summary:not([hidden]), [contenteditable]:not([hidden]), audio[controls]:not([hidden]), video[controls]:not([hidden])'),s.addEventListener("keydown",n=function(t){var e=o[u.DCFUtility.magicNumbers("int0")],n=o[o.length-u.DCFUtility.magicNumbers("int1")];"Tab"!==t.key&&9!==t.keyCode||"Tab"!==t.key&&9!==t.keyCode||(t.shiftKey?document.activeElement===s?(t.preventDefault(),e.focus()):document.activeElement===e&&(t.preventDefault(),n.focus()):document.activeElement===n&&(t.preventDefault(),e.focus()))}),document.addEventListener("ModalCloseEvent_".concat(e),function(){s.removeEventListener("keydown",n)}),i="ModalOpenEvent_".concat(e),document.dispatchEvent(new CustomEvent(i)))}},{key:"closeModal",value:function(t){var e=document.getElementById("dcf-nav-toggle-group"),n=e&&e.parentElement?e.parentElement:null,o=document.getElementById(t),i=o.dataset.confirmClose,a="true"===o.getAttribute("aria-hidden");this.currentModal=null,a||(a="ModalPreCloseEvent_".concat(t),document.dispatchEvent(new CustomEvent(a)),i&&!window.confirm(i))||(this.body.classList.remove("dcf-modal-is-open"),this.currentBtn&&(a=document.getElementById(this.currentBtn))&&"true"===a.getAttribute("data-with-nav-toggle-group")&&this.setNavToggleBtnState(a,"open"),this.nonModals.forEach(function(t){e&&t===n&&n.childNodes.forEach(function(t){t.nodeType===Node.ELEMENT_NODE&&t.setAttribute("aria-hidden","false")}),t.setAttribute("aria-hidden","false")}),o.setAttribute("aria-hidden","true"),o.classList.remove("dcf-opacity-100","dcf-pointer-events-auto","dcf-z-modal-behind-nav-toggle-group"),o.classList.add("dcf-opacity-0","dcf-pointer-events-none"),o.addEventListener("transitionend",function t(){o.removeEventListener("transitionend",t),o.classList.contains("dcf-invisible")||o.classList.add("dcf-invisible")}),this.currentBtn&&document.getElementById(this.currentBtn).focus(),this.enableBodyScroll&&this.enableBodyScroll(o),i="ModalCloseEvent_".concat(t),document.dispatchEvent(new CustomEvent(i)))}},{key:"btnToggleListen",value:function(e,n,o){var i=this;e.addEventListener("click",function(){var t=o;o!==e.id&&(t=e.id),i.toggleModal(n,t)},!1)}},{key:"btnCloseListen",value:function(t,e){var n=this;t.addEventListener("click",function(){n.closeModal(e.getAttribute("id"))},!1)}},{key:"overlayListen",value:function(e,n){var o=this;e.addEventListener("click",function(t){n.contains(t.target)||o.closeModal(e.getAttribute("id"))})}},{key:"escListen",value:function(){var e=this;document.addEventListener("keydown",function(t){u.DCFUtility.isKeyEvent(t,u.DCFUtility.keyEvents("escape"))&&e.currentModal&&(t.preventDefault(),e.closeModal(e.currentModal))})}},{key:"initialize",value:function(){var s=this;this.modals&&this.modals.forEach(function(t){var n=t.getAttribute("id"),e=document.querySelectorAll(".dcf-btn-toggle-modal[data-toggles-modal='".concat(n,"']")),o=t.querySelector(".dcf-btn-close-modal"),i=t.querySelector(".dcf-modal-wrapper"),a=t.querySelector(".dcf-modal-content"),d=t.querySelector(".dcf-modal-header");if(null===o)throw new Error("Modal is missing close button: \n ".concat(t.outerHTML));if(null===i)throw new Error("Modal is missing wrapper: \n ".concat(t.outerHTML));if(null===a)throw new Error("Modal is missing content: \n ".concat(t.outerHTML));if(null===d)throw new Error("Modal is missing header: \n ".concat(t.outerHTML));e.forEach(function(t){var e=u.DCFUtility.uuidv4();void 0!==t.id&&""!==t.id&&(e=t.id),t.setAttribute("id",e),t.removeAttribute("disabled"),s.btnToggleListen(t,n,e)});var e="".concat(n,"-heading"),l=void 0!==t.dataset.deliberateCloseOnly&&"false"!==t.dataset.deliberateCloseOnly.toLowerCase();d.querySelectorAll("h1, h2, h3, h4, h5, h6")[u.DCFUtility.magicNumbers("int0")].id=e,s.appendToBody(t),t.removeAttribute("hidden"),t.setAttribute("aria-labelledby",e),t.setAttribute("aria-hidden","true"),t.setAttribute("role","dialog"),t.setAttribute("tabindex","-1"),t.classList.length===u.DCFUtility.magicNumbers("int1")&&t.classList.contains("dcf-modal")&&t.classList.add("dcf-bg-overlay-dark"),t.classList.add("dcf-fixed","dcf-top-0","dcf-left-0","dcf-h-100%","dcf-w-100%","dcf-d-flex","dcf-ai-center","dcf-jc-center","dcf-opacity-0","dcf-pointer-events-none","dcf-invisible"),i.setAttribute("role","document"),i.classList.length===u.DCFUtility.magicNumbers("int1")&&i.classList.contains("dcf-modal-wrapper")&&i.classList.add("dcf-relative","dcf-h-auto","dcf-overflow-y-auto"),d.classList.length===u.DCFUtility.magicNumbers("int1")&&d.classList.contains("dcf-modal-header")&&d.classList.add("dcf-wrapper","dcf-pt-8","dcf-sticky","dcf-top-0"),o.classList.length===u.DCFUtility.magicNumbers("int1")&&o.classList.contains("dcf-btn-close-modal")&&o.classList.add("dcf-btn","dcf-btn-tertiary","dcf-absolute","dcf-top-0","dcf-right-0","dcf-z-1"),a.classList.length===u.DCFUtility.magicNumbers("int1")&&a.classList.contains("dcf-modal-content")&&a.classList.add("dcf-wrapper","dcf-pb-8"),o.setAttribute("type","button"),o.setAttribute("aria-label","Close"),s.escListen(),l||s.overlayListen(t,i),s.btnCloseListen(o,t)})}}])&&o(t.prototype,e),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}()});