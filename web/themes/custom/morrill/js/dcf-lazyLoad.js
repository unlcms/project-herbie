define(["exports"],function(e){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=n(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0===a)return("string"===t?String:Number)(e);a=a.call(e,t||"default");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"==n(e)?e:e+""}(r.key),r)}}Object.defineProperty(e,"__esModule",{value:!0}),e.DCFLazyLoad=void 0;e.DCFLazyLoad=function(){function r(e,t,a){if(!(this instanceof r))throw new TypeError("Cannot call a class as a function");this.itemList=e,this.observerConfig=t,this.classNames=a}return e=r,(t=[{key:"pxTOvw",value:function(e){var t=document.documentElement,a=document.getElementsByTagName("body")[0],t=window.innerWidth||t.clientWidth||a.clientWidth;return"".concat(100*e/t,"vw")}},{key:"applyImage",value:function(t){var e=t.dataset.src,a=t.dataset.srcset||null,r=null;e&&(r="PICTURE"===t.parentNode.nodeName?(this.applyPicture(t.parentNode),t.dataset.sizes||this.pxTOvw(t.parentNode.parentElement.clientWidth)):t.dataset.sizes||this.pxTOvw(t.parentElement.clientWidth),t.classList.add("dcf-lazy-loaded"),t.classList.remove("dcf-lazy-load"),e&&(t.src=e,t.removeAttribute("data-src")),a&&(t.srcset=a,t.removeAttribute("data-srcset")),r&&(t.sizes=r,t.removeAttribute("data-sizes")),this.classNames.length)&&this.classNames.forEach(function(e){return t.classList.add(e)})}},{key:"fetchImage",value:function(r){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return new Promise(function(e,t){var a=new Image;r&&(a.src=r),n&&(a.srcset=n),s&&(a.sizes=s),a.onload=e,a.onerror=t}).catch(function(){})}},{key:"preloadImage",value:function(e){var t=e.dataset.src,a=e.dataset.srcset,e=e.dataset.sizes||null,r=null;if(t)try{r=this.fetchImage(t,a,e)}catch(e){}return r}},{key:"applyPicture",value:function(r){var n=this,e=r.getElementsByTagName("SOURCE");Array.from(e).forEach(function(e){var t=e.dataset.srcset||null,a=e.dataset.sizes||n.pxTOvw(r.parentElement.clientWidth);t&&(e.srcset=t,e.removeAttribute("data-srcset"),a)&&(e.sizes=a,e.removeAttribute("data-sizes"))})}},{key:"applyVideo",value:function(t){var e=t.getElementsByTagName("SOURCE"),a=t.dataset.poster||null;Array.from(e).forEach(function(e){var t=e.dataset.src||null;t&&(e.src=t,e.removeAttribute("data-src"))}),a&&(t.poster=a,t.removeAttribute("data-poster")),t.classList.add("dcf-lazy-loaded"),t.classList.remove("dcf-lazy-load"),this.classNames.length&&this.classNames.forEach(function(e){return t.classList.add(e)}),t.load()}},{key:"loadItemsImmediately",value:function(e){var t=this,a=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];e.forEach(function(e){switch(e.nodeName){case"IMG":!0===a&&t.preloadImage(e),t.applyImage(e);break;case"VIDEO":t.applyVideo(e);break;default:return}})}},{key:"disconnect",value:function(){this.observer&&this.observer.disconnect()}},{key:"initialize",value:function(){var a=this;this.itemList&&(this.itemsCount=this.itemList.length,"IntersectionObserver"in window?(this.observer=new IntersectionObserver(function(e,t){0===a.itemsCount&&a.observer.disconnect(),e.forEach(function(e){switch(e.target.nodeName){case"IMG":e.intersectionRatio>t.thresholds[0]&&e.intersectionRatio<t.thresholds[1]?a.preloadImage(e.target):e.intersectionRatio>t.thresholds[1]&&(a.itemsCount--,a.applyImage(e.target),a.observer.unobserve(e.target));break;case"VIDEO":e.intersectionRatio>t.thresholds[1]&&(a.itemsCount--,a.applyVideo(e.target),a.observer.unobserve(e.target));break;default:return}})},this.observerConfig),this.itemList.forEach(function(e){e.classList.contains("dcf-lazy-loaded")||("loading"in HTMLImageElement.prototype&&"IMG"===e.nodeName?(a.itemsCount--,a.applyImage(e)):a.observer.observe(e))})):this.loadItemsImmediately(this.itemList,"loading"in HTMLImageElement.prototype))}}])&&s(e.prototype,t),a&&s(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,a}()});